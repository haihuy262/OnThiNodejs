<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  </head>
  <body>
    <div class="container mt-3">
      <h2 class="text-center">Danh sách xe máy</h2>
      <div class="mb-3">
        <input
          type="text"
          id="searchInput"
          class="form-control"
          placeholder="Tìm kiếm..."
        />
      </div>
      <table class="table mt-3" id="xeMayTable">
        <thead class="table-dark">
          <tr>
            <th>Tên xe</th>
            <th>Hãng sản xuất</th>
            <th>Ảnh xe máy</th>
            <th>Giá tiền</th>
            <th>Xoá</th>
            <th>Sửa</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <script>
      $(document).ready(function () {
        // Xác định đối tượng tìm kiếm
        const searchInput = $("#searchInput");
        // Xác định đối tượng bảng
        const table = $("#xeMayTable");
        // Xác định đối tượng dòng trong bảng
        const rows = $("#xeMayTable tbody tr");
        // Xử lý sự kiện khi người dùng nhập vào thanh tìm kiếm
        searchInput.on("input", function () {
          const searchTerm = $(this).val().toLowerCase();
          // Lặp qua mỗi dòng trong bảng để ẩn hoặc hiển thị dựa trên kết quả tìm kiếm
          rows.each(function () {
            const rowText = $(this).text().toLowerCase();
            if (rowText.includes(searchTerm)) {
              $(this).show();
            } else {
              $(this).hide();
            }
          });
        });
      });

      $(document).ready(async function () {
        try {
          const response = await $.ajax({
            url: "/api/danhSachXeMay/xemay",
            method: "GET",
            dataType: "json",
          });

          renderProducts(response);
        } catch (error) {
          console.error("Error fetching products:", error);
        }

        function renderProducts(xemays) {
          const tableBody = $("#xeMayTable tbody");

          xemays.forEach((xemay) => {
            console.log(`${xemay.anhXeMay[0]}`);
            const row = $("<tr>").html(`
          <td><img src="images/${xemay.anhXeMay[0].filename}" alt="${xemay.tenXeMay}" style="width: 50px; height: 50px;">
            <img src="images/${xemay.anhXeMay[1].filename}" alt="${xemay.tenXeMay}" style="width: 50px; height: 50px;"></td>
          <td>${xemay.tenXeMay}</td>
          <td>${xemay.giaTien}</td>
          <td>${xemay.hangSanXuat}</td>
          <td><a href="/delete/byId/${xemay._id}">Delete</a></td>
          <td><a href="/edit/${xemay._id}">Edit</a></td>
        `);
            tableBody.append(row);
          });
        }
      });
    </script>
  </body>
</html>
